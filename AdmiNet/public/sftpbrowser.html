<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SFTP File Browser</title>
    <link rel="stylesheet" href="css/sftp.css">
    <script src="js/SFTPFunctions.js"></script>
</head>
<body>
    <div class="app">
        <div class="main">
            <div id="sftp-action-buttons">
                <label for="file-input" id="file-input-label">
                    <p>Choose file</p>
                </label>
                <input type="file" id="file-input" value="Choose file">
                <button id="upload-file" onclick="uploadFile()">Upload File</button>
            </div>
            
            <div id="fileBrowser" class="content">
                <h2 id="path"></h2>
                <table id="fileTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Size</th>
                            <th>Modified</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            username = sessionStorage.getItem('ssh_user')
            password = sessionStorage.getItem('ssh_pass')
            const initialFiles = sessionStorage.getItem('initial_files')
            const initialDir = sessionStorage.getItem('initial_dir')

            if (!username || !password) {
                alert('Not logged in!')
                window.location.href = 'index.html'
                return
            }

            if (initialFiles && initialDir) {
                renderFiles(JSON.parse(initialFiles), initialDir)
                sessionStorage.removeItem('initial_files')
                sessionStorage.removeItem('initial_dir')
            } else {
                loadDir('.')
            }
        })
    </script>
</body>
</html>